function splot_trajectory(self, cel, varargin)
% Plots scaled trajectory
%
% Plots animal trajectory for root.epochs (if multiple, they are all
% plotted on top of one another), along with spikes overlayed in red dots.
%
% andrew 3 april 2010

p = inputParser;

p.addRequired('self')
p.addRequired('cel', @isnumeric)
p.addParamValue('show_scale', 1, @isnumeric)
p.addParamValue('ScatterParams', {'.r', 'SizeData', 50}, @iscell);
p.addParamValue('dotColor',0, @isnumeric);

p.parse(self, cel, varargin{:});

self = p.Results.self;
cel = p.Results.cel;
show_scale = p.Results.show_scale;
ScatterParams = p.Results.ScatterParams;
dotcol = p.Results.dotColor;

import CMBHOME.Utils.*
pad = [-.03 .02]; % percent padding around plot
[spk_x, spk_y, spk_hd] = ContinuizeEpochs(self.cel_sx, self.cel_sy, self.cel_sheaddir);

x = Cell2MatPlus(self.sx);
y = Cell2MatPlus(self.sy);
 
line(x, y, 'Color', [0.5 0.5 0.5]), hold on;

scatter(spk_x, spk_y, 30, dotcol, 'filled'), hold off

axis equal
 
axis off
 
set(gca, 'Box', 'on')

xs = [min(min(x)) max(max(x))];
ys = [min(min(y)) max(max(y))];

xlim(diff(xs).*pad+xs);
ylim(diff(ys).*pad+ys);
 
%     if show_scale
%         line([xs(1)+.75*diff(xs), xs(2)], [-.03*diff(ys)+ys(1), -.03*diff(ys)+ys(1)], 'Color', 'k', 'LineWidth', 2);
%         text(xs(2), -.03*diff(ys)+ys(1), [num2str(.25*diff(xs), 3) ' cm'], 'FontSize', 9, 'FontWeight', 'bold', 'HorizontalAlign', 'right', 'VerticalAlign', 'bottom');
%     end
%     
%title('Animal Trajectory with Spikes');

end